<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" th:href="@{/images/member/favicon.png}">
    <title>[[${basicData.title}]]-[[${basicData.sub_title}]]::관리자 공지사항 목록 [[${appInfo.appVersion}]]</title>
    <style>
        body {
          margin: 0;
          background-color: #f5f5f5;
        }
        /*///////////////헤더 푸터 삽입 시 공백 제거///////////////////*/
        html, body {
            margin: 0;
            padding: 0;
        }

        /*////////////////////// header영역 //////////////////////*/
        .header-layout{
            height: 60px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
            background-color: #325a83;
            display: flex;
            vertical-align: middle;
            align-items: center;
            justify-content: center;
        }

        .header-content{
            width: 80%;
            display: flex;
            justify-content: space-between;
            display: flex;
            align-items: center;
        }
        .header-content img{
            width: 200px;
            display: block;
        }

        .header-link{
            display: flex;
            gap: 25px;
            vertical-align: middle;
            align-items: center;
        }
        .header-link p{
            margin: 0;
        }

        .header-link a,
        .header-link button{
            text-decoration: none;
            color: white;
            font-weight: 500;
            font-size: 10px;
        }

        .header-item a{
            display: flex;
            flex-direction: column;
            align-items: center;
            color: white;

        }
        .header-link button{
            border: none;
            outline: none;
            background-color: #91a9ce;
            padding: 5px 15px 5px 15px;
            cursor: pointer;
        }
        /*////////////////////// footer영역 //////////////////////*/
        .footer-layout{
            height: 110px;
            margin: 0 auto;
            width: 100%;
            background-color: #325a83;
        }

        .footer-content{
            width: 1200px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            padding-top: 15px;
            text-align: center;
            gap: 2px;
        }
        .footer-content img{
            width: 150px;
            display: block;
            margin: 0 auto;
        }
        .about-company{
            display: flex;
            justify-content: center;
        }
        .footer-content h2{
            font-size: 12px;
            color: #333;
            font-weight: 400;
            margin: 0 2px;
        }
        .footer-content a{
            color: black;
            font-size: 13px;
        }

        /*///////////////////사이드 바///////////////////*/
        .sidebar {
            width: 200px;
            display: flex;
            flex-direction: column;
            background-color: #e0e0e0;

        }

        .sidebar a {
            text-decoration: none;
        }

        .side-item {
            border-bottom: 1px solid #ccc;
        }
        .main-menu p {
            color: black;
            font-size: 15px;
            cursor: pointer;
            margin: 0;

        }

        .main-menu{
            display: flex;
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            display: flex;
            align-items: center;
        }
        .sub-menu{
            display: flex;
            flex-direction: column;
            gap: 6px;
            display: none;
        }

        .sub-menu.active {
            display: flex;
        }
        .sub-menu a{
            color: black;
            font-size: 14px;
        }

        .sub-menu ul,
        .sub-menu li {
            margin: 0;
            list-style-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10"  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/></svg>');
        }

        .main-menu svg{
            width: 17px;
            height: 17px;
            margin-right: 10px;
        }

        .side-item .main-menu:hover{
            background-color: #ccc;
        }

        .side-item.active .main-menu {
            background-color: #666;
        }

        .side-item.active .main-menu,
        .side-item.active .main-menu p{
            color: white;
            font-weight: 500;
        }

        .sub-menu a.active {
            font-weight: bold;
        }

        /* 메인 콘텐츠 */
        .content {
          flex: 1;
          padding: 20px;
          background-color: #fff;
        }

        /* 제목과 브레드크럼 같은 줄, 전체 밑줄 적용 */
        .header-top {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 20px;
          border-bottom: 2px solid #000;
          padding-bottom: 10px;
        }
        .container {
            display: flex;
            min-height: 80vh;
            margin: 0 auto;
            max-width: 1200px;
        }
        .header-top h1 {
          font-size: 20px;
          margin: 0;
          border-bottom: none;
        }

        .breadcrumb {
          font-size: 14px;
        }

        .breadcrumb a {
          text-decoration: none;
          color: #007bff;
        }

        .breadcrumb span {
          color: #555;
        }

        .breadcrumb a:hover {
          text-decoration: underline;
        }

        .top-bar {
          display: flex;
          justify-content: space-between;
          align-items: center;
          font-size: 14px;
          background-color: #eee;
          padding: 10px 20px;
          margin-bottom: 10px;
        }

        .search-bar {
          margin-bottom: 10px;
        }

        #notice_type {
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .search-bar select,
        .search-bar input {
            margin-right: 5px;
            outline: none;
            padding: 5px;
        }

        table {
          width: 100%;
          border-collapse: collapse;
          font-size: 14px;
        }

        th, td {
          border: 1px solid #ddd;
          padding: 10px;
          text-align: center;
        }

        th {
          background-color: #f0f0f0;
        }

        .bottom-bar {
          margin-top: 15px;
          display: flex;
          justify-content: space-between;
          align-items: center;
        }

        .pagination a {
          margin: 0 5px;
          text-decoration: none;
          color: #000;
        }

        .btn {
          padding: 6px 12px;
          background-color: #3693c2;
          color: white;
          border: none;
          cursor: pointer;
        }

        .btn2 {
          padding: 6px 12px;
          background-color: #bfbfbf;
          color: white;
          border: none;
          cursor: pointer;
        }

        .btn:hover {
          background-color: #2980b9;
        }

        /* 공지사항 관리 링크 세로 배치 */
        .action a {
          display: block;
          text-decoration: none;
          color: black;
          margin-bottom: 4px;
        }

        .action a:last-child {
          margin-bottom: 0;
        }

        .notice_a {
            color: black;
            text-decoration: none;
        }
    </style>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            //체크박스 전체 선택
            const allSelect = document.querySelector(".all_select");
            const checkboxes = document.querySelectorAll("tbody input[type='checkbox']");

            allSelect.addEventListener("change", function() {
                checkboxes.forEach(cb => cb.checked = allSelect.checked);
            });

            const notice_type = document.getElementById("notice_type");
            notice_type.addEventListener("change", function() {
                const nType = notice_type.value;
                if(nType) {
                    window.location.href = `/kmarket/admin/cs/notice/list/${nType}`;
                }
            });

            //삭제 기능
            const deleteBtn = document.querySelector(".select_delete");
            deleteBtn.addEventListener("click", async () => {
                const selected = document.querySelectorAll("tbody .row-checkbox:checked");
                const idList = Array.from(selected).map(cb => cb.value);
                console.log("삭제 id리스트: ", idList);

                const response = await fetch("/kmarket/admin/cs/notice/list", {
                    method: "DELETE",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(idList)
                });

                if(response.ok) {
                    alert("삭제 완료!");
                    location.reload();
                } else {
                    alert("삭제 실패!");
                }
            });
        });
    </script>
    <!-- header/footer css -->
    <link rel="stylesheet" th:href="@{/css/admin/main/header_footer.css}">

    <script th:src="@{/js/admin/cs/recruit/sidebarAction.js}" defer></script>
    <link rel="stylesheet" th:href="@{/css/admin/main/sidebar.css}">
</head>
<body>
    <header>
        <div class="header-layout">
            <div class="header-content">
                <a th:href="@{/admin}">
                    <img th:src="@{/images/admin/main/cupangMS_logo(color).png}" alt="로고">
                </a>
                <div class="header-link">
                    <div class="header-item">
                        <a th:href="@{/}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-house-icon lucide-house"><path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"/><path d="M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg>
                            <p>HOME</p>
                        </a>
                    </div>

                    <div class="header-item">
                        <a th:href="@{/cs/index}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-headset-icon lucide-headset"><path d="M3 11h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-5Zm0 0a9 9 0 1 1 18 0m0 0v5a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3Z"/><path d="M21 16v2a4 4 0 0 1-4 4h-5"/></svg>
                            <p>고객센터</p>
                        </a>
                    </div>

                    <button>로그아웃</button>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- 사이드바 -->
        <aside class="sidebar">
            <div class="side-item">
                <div class="main-menu">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-settings-icon lucide-settings"><path d="M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915"/><circle cx="12" cy="12" r="3"/></svg>
                   <p>환경설정</p>
                </div>
                <ul class="sub-menu">
                    <li><a th:href="@{/admin/config/basic}" class="sub-link">기본설정</a></li>
                    <li><a th:href="@{/admin/config/banner}" class="sub-link">배너관리</a></li>
                    <li><a th:href="@{/admin/config/policy}" class="sub-link">약관관리</a></li>
                    <li><a th:href="@{/admin/config/category}" class="sub-link">카테고리</a></li>
                    <li><a th:href="@{/admin/config/version}" class="sub-link">버전관리</a></li>
                </ul>
            </div>
            <div class="side-item">
                <div class="main-menu">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-store-icon lucide-store"><path d="M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5"/><path d="M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244"/><path d="M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05"/></svg>
                    <p>상점관리</p>
                </div>
                <ul class="sub-menu">
                    <li><a th:href="@{/admin/shop/list}" class="sub-link">상점목록</a></li>
                    <li><a th:href="@{/admin/shop/sales}" class="sub-link">매출현황</a></li>
                </ul>
            </div>
            <div class="side-item">
                <div class="main-menu">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user-pen-icon lucide-user-pen"><path d="M11.5 15H7a4 4 0 0 0-4 4v2"/><path d="M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z"/><circle cx="10" cy="7" r="4"/></svg>
                    <p>회원관리</p>
                </div>
                <ul class="sub-menu">
                    <li><a th:href="@{/admin/member/list}" class="sub-link">회원목록</a></li>
                    <li><a th:href="@{/admin/member/point}" class="sub-link">포인트관리</a></li>
                </ul>
            </div>
            <div class="side-item">
                <div class="main-menu">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-package-open-icon lucide-package-open"><path d="M12 22v-9"/><path d="M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z"/><path d="M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13"/><path d="M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z"/></svg>
                    <p>상품관리</p>
                </div>
                <ul class="sub-menu">
                    <li><a th:href="@{/admin/product/list}" class="sub-link">상품목록</a></li>
                    <li><a th:href="@{/admin/product/register}" class="sub-link">상품등록</a></li>
                </ul>
            </div>
            <div class="side-item">
               <div class="main-menu">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-receipt-text-icon lucide-receipt-text"><path d="M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z"/><path d="M14 8H8"/><path d="M16 12H8"/><path d="M13 16H8"/></svg>
                   <p>주문관리</p>
                </div>
                <ul class="sub-menu">
                    <li><a th:href="@{/admin/order/list}" class="sub-link">주문현황</a></li>
                    <li><a th:href="@{/admin/order/delivery}" class="sub-link">배송현황</a></li>
                </ul>
            </div>
            <div class="side-item">
               <div class="main-menu">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ticket-percent-icon lucide-ticket-percent"><path d="M2 9a3 3 0 1 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 1 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="M9 9h.01"/><path d="m15 9-6 6"/><path d="M15 15h.01"/></svg>
                   <p>쿠폰관리</p>
                </div>
                <ul class="sub-menu">
                    <li><a th:href="@{/admin/coupon/list}" class="sub-link">쿠폰목록</a></li>
                    <li><a th:href="@{/admin/coupon/issued}" class="sub-link">쿠폰발급현황</a></li>
                </ul>
            </div>
            <div class="side-item">
                <div class="main-menu">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-laptop-minimal-check-icon lucide-laptop-minimal-check"><path d="M2 20h20"/><path d="m9 10 2 2 4-4"/><rect x="3" y="4" width="18" height="12" rx="2"/></svg>
                    <p>고객센터</p>
                </div>
                <ul class="sub-menu">
                    <li><a th:href="@{/admin/cs/notice/list}" class="sub-link">공지사항</a></li>
                    <li><a th:href="@{/admin/cs/faq/list}" class="sub-link">자주묻는질문</a></li>
                    <li><a th:href="@{/admin/cs/qna/list}" class="sub-link">문의하기</a></li>
                    <li><a th:href="@{/admin/cs/recruit/list}" class="sub-link">채용하기</a></li>
                </ul>
            </div>
        </aside>

        <!-- 메인 콘텐츠 -->
        <div class="content">
            <div class="header-top">
                <h1>공지사항 목록</h1>
                <div class="breadcrumb">
                <a href="#">HOME</a> &gt;
                <a href="#">고객센터</a> &gt;
                <span>공지사항</span>
            </div>
        </div>

        <div class="search-bar">
          <select name="notice_type" id="notice_type">
            <option>유형선택</option>
            <option value="csService">고객서비스</option>
            <option value="safeTrade">안전거래</option>
            <option value="dangerProduct">위해상품</option>
            <option value="event">이벤트 당첨</option>
          </select>
        </div>

        <table>
            <thead>
                <tr>
                  <th><input type="checkbox" class="all_select"></th>
                  <th>번호</th>
                  <th>유형</th>
                  <th>제목</th>
                  <th>조회</th>
                  <th>날짜</th>
                  <th>관리</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="notice, stat:${pageResponseDTO.dtoList}">
                  <td><input type="checkbox" class="row-checkbox" th:value="${notice.id}"></td>
                  <td>[[${notice.id}]]</td>
                  <td>[[${notice.notice_type}]]</td>
                  <td><a th:href="@{/admin/cs/notice/view(id=${notice.id})}" class="notice_a">[[${notice.title}]]</a></td>
                  <td>[[${notice.views}]]</td>
                    <td th:text="${#temporals.format(notice.reg_date, 'yy.MM.dd')}"></td>
                  <td class="action">
                    <a th:href="@{/admin/cs/notice/delete(id=${notice.id})}">[삭제]</a>
                    <a th:href="@{/admin/cs/notice/modify(id=${notice.id})}">[수정]</a>
                  </td>
                </tr>
            </tbody>
        </table>

        <div class="bottom-bar">
          <div>
            <button class="btn2 select_delete">선택삭제</button>
          </div>
          <div class="pagination">
              <a th:if="${pageResponseDTO.prev}"
                 th:href="@{/admin/cs/notice/list(pg=${pageResponseDTO.start - 1})}" class="arrow">
                  <span class="prev"></span>
              </a>
              <th:block th:if="${pageResponseDTO.total > 0}" th:each="num:${#numbers.sequence(pageResponseDTO.start, pageResponseDTO.end)}">
                  <a th:href="@{/admin/cs/notice/list (pg=${num})}"
                     th:class="${num == pageResponseDTO.pg ? 'active2' : 'pageNum'}">[[${num}]]</a>
              </th:block>
              <a th:if="${pageResponseDTO.next}"
                 th:href="@{/admin/cs/notice/list(pg=${pageResponseDTO.end + 1})}" class="arrow">
                  <span class="next"></span>
              </a>
          </div>
          <div>
            <button class="btn" th:onclick="|location.href='@{/admin/cs/notice/write}'|">작성하기</button>
          </div>
        </div>
      </div>
    </div>
    <footer>
        <div class="footer-layout">
            <div class="footer-content">
                <img th:src="@{/images/admin/main/cupangMS_logo(color).png}" alt="로고">
                <div class="about-company">
                    <h2>(주)큐팡</h2>
                    <h2>대표이사 이름(db)</h2>
                    <h2>|</h2>
                    <h2>사업자등록번호</h2>
                    <h2>123-132-1231232(db)</h2>
                    <h2>|</h2>
                    <h2>통신판매업신고</h2>
                    <h2>2023-부산 해운대구-1232(db)</h2>
                    <h2>|</h2>
                    <h2>부산광역시 부산진구 중앙동(db)</h2>
                    <h2>(삼성동, green빌딩) 7층(db)</h2>
                </div>
                <div class="about-company">
                    <h2>고객센터</h2>
                    <h2>|</h2>
                    <h2>02-1234-1231</h2>
                    <h2>평일 09:00 ~ 18:00(db)</h2>

                    <h2>이메일</h2>
                    <h2>abc@cupang(db)</h2>

                    <h2>전자금융거래 분쟁담당</h2>
                    <h2>12321-12321(db)</h2>
                </div>
                <h2>Copyright@cupang.All.rights.reserved (db)</h2>
            </div>
        </div>
    </footer>
</body>
</html>
