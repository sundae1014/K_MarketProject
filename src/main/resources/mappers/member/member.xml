<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.kmarket.mapper.MemberMapper">
    <insert id="insertMember" parameterType="kr.co.kmarket.dto.MemberDTO">
        INSERT INTO MEMBER(
        cust_number, name, custid, pw, hp, email, gender,
        stat, auth, useterm, company_name, business_number,
        ecommerce_number, fax_number, zip, addr1, addr2, operation, birth, "Date"
        ) VALUES (
        MEMBER_SEQ.NEXTVAL,
        #{name},
        #{custid},
        #{pw},
        #{hp, jdbcType=VARCHAR},
        #{email,jdbcType=VARCHAR},
        #{gender,jdbcType=NUMERIC},
        #{stat},
        #{auth},
        #{useterm,jdbcType=VARCHAR},
        #{company_name,jdbcType=VARCHAR},
        #{business_number,jdbcType=VARCHAR},
        #{ecommerce_number,jdbcType=VARCHAR},
        #{fax_number,jdbcType=VARCHAR},
        #{zip,jdbcType=VARCHAR},
        #{addr1,jdbcType=VARCHAR},
        #{addr2,jdbcType=VARCHAR},
        #{operation,jdbcType=VARCHAR},
        #{birth,jdbcType=VARCHAR},
        SYSDATE
        )
    </insert>

    <select id="findByCustid" parameterType="string" resultType="kr.co.kmarket.dto.MemberDTO">
        SELECT * FROM MEMBER WHERE custid = #{custid}
    </select>

    <select id="countByCustid" parameterType="string" resultType="int">
        SELECT COUNT(*) FROM MEMBER WHERE custid = #{custid}
    </select>

    <select id="countByEmail" parameterType="string" resultType="int">
        SELECT COUNT(*) FROM MEMBER WHERE email = #{email}
    </select>

    <select id="countByHp" parameterType="string" resultType="int">
        SELECT COUNT(*) FROM MEMBER WHERE hp = #{hp}
    </select>

    <select id="findCustIdInfo" resultType="kr.co.kmarket.dto.MemberDTO">
        SELECT custid, name, email, "Date" FROM member WHERE name = #{name} AND email = #{email}
    </select>

    <select id="findCustIdInfoHp" resultType="kr.co.kmarket.dto.MemberDTO">
        SELECT custid, name, hp, "Date" FROM member WHERE name = #{name} AND hp = #{hp}
    </select>

    <update id="updatePw">
        UPDATE member SET pw = #{pw} WHERE custid = #{custid}
    </update>

    <select id="selectAllPolicy" resultType="kr.co.kmarket.dto.PolicyDTO">
        SELECT *
        FROM POLICY
        ORDER BY POLICY_TYPE, POLICY_NO
    </select>
</mapper>