<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.kmarket.mapper.admin.CouponMapper">

    <!-- ✅ 컬럼 ↔ DTO 필드 매핑 -->
    <resultMap id="couponMap" type="kr.co.kmarket.dto.CouponDTO">
        <result column="COUPON_NO" property="couponNo"/>
        <result column="COUPON_TYPE" property="couponType"/>
        <result column="COUPON_NAME" property="couponName"/>
        <result column="BENEFIT" property="benefit"/>
        <result column="USE_PERIOD" property="usePeriod"/>
        <result column="ISSUER" property="issuer"/>
        <result column="ISSUE_DATE" property="issueDate"/>
        <result column="USE_COUNT" property="useCount"/>
        <result column="STATUS" property="status"/>
        <result column="MANAGE" property="manage"/>
        <result column="SAYOUNG" property="sayoung"/>
        <result column="BARGUP" property="bargup"/>
    </resultMap>


    <!-- ✅ 쿠폰 등록 -->
    <insert id="insertCoupon" parameterType="kr.co.kmarket.dto.CouponDTO">
        INSERT INTO COUPON (
            COUPON_NO,
            COUPON_TYPE,
            COUPON_NAME,
            BENEFIT,
            USE_PERIOD,
            ISSUER,
            ISSUE_DATE,
            USE_COUNT,
            STATUS,
            MANAGE,
            SAYOUNG,
            BARGUP
        ) VALUES (
                     COUPON_SEQ.NEXTVAL,
                     #{couponType, jdbcType=INTEGER},
                     #{couponName, jdbcType=VARCHAR},
                     #{benefit, jdbcType=VARCHAR},
                     #{usePeriod, jdbcType=VARCHAR},
                     #{issuer, jdbcType=VARCHAR},
                     #{issueDate, jdbcType=DATE},
                     #{useCount, jdbcType=INTEGER},
                     #{status, jdbcType=VARCHAR},
                     #{manage, jdbcType=VARCHAR},
                     #{sayoung, jdbcType=INTEGER},
                     #{bargup, jdbcType=INTEGER}
                 )
    </insert>


    <!-- ✅ 쿠폰 목록 -->
    <select id="selectCoupons" resultMap="couponMap">
        SELECT
            COUPON_NO,
            COUPON_TYPE,
            COUPON_NAME,
            BENEFIT,
            USE_PERIOD,
            ISSUER,
            ISSUE_DATE,
            USE_COUNT,
            STATUS,
            MANAGE,
            SAYOUNG,
            BARGUP
        FROM COUPON
        ORDER BY COUPON_NO DESC
    </select>

</mapper>
