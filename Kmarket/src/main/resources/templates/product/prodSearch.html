<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>Cupang::상품검색</title>
    <link rel="stylesheet" th:href="@{/css/product/style_index.css}">
    <link rel="stylesheet" th:href="@{/css/product/style_prodSearch.css}">
    <link rel="stylesheet" th:href="@{/css/product/style_prodList.css}">
    <link rel="stylesheet" th:href="@{/css/product/style_prodView.css}">
    <link rel="stylesheet" th:href="@{/css/product/style_header.css}">
    <link rel="stylesheet" th:href="@{/css/product/style_footer.css}">

    <!-- 유저별 권한 기능 -->
    <script th:src="@{/js/product/user-menu.js}" defer></script>
    <!-- 검색 기능 -->
    <script th:src="@{/js/product/search.js}" defer></script>
    <!-- 전체 카테고리 구현 기능 -->
    <script th:src="@{/js/product/category.js}" defer></script>
    <!-- 베스트상품 온앤오프 & 스크롤 기능 -->
    <script th:src="@{/js/product/best.js}" defer></script>
    <!-- 옵션 선택 기능 -->
    <script th:src="@{/js/product/option.js}" defer></script>
    <!-- 찜하기/장바구니/바로구매 기능 -->
    <script th:src="@{/js/product/prod-actions.js}" defer></script>
    <!-- 2차 카테고리 > 상품 목록 타이틀 갱신 기능 -->
    <script th:src="@{/js/product/list-title.js}" defer></script>
    <!-- 기준별 목록 정렬 기능 -->
    <script th:src="@{/js/product/category-sort.js}" defer></script>
    <!-- TOP 버튼(맨 위로) 기능 -->
    <script th:src="@{/js/product/top-btn.js}" defer></script>
</head>
<body>
    <main class="page">

        <!-- 헤더 -->
        <div th:replace="_header :: headerFragment"></div>

        <div class="order-wrap">

            <!-- 상품 경로 -->
            <div class="search-wrap container">

                <!-- 베스트상품 -->
                <aside class="col-a">
                    <div class="best-panel">
                        <h3 class="section-title">베스트상품</h3>
                        <ol class="best-num-list" id="best-num-list">
                            <li><button data-idx="0">NO.1</button></li>
                            <li><button data-idx="1">NO.2</button></li>
                            <li><button data-idx="2">NO.3</button></li>
                            <li><button data-idx="3">NO.4</button></li>
                            <li><button data-idx="4">NO.5</button></li>
                        </ol>
                    </div>
                </aside>

                <!-- 우측: 상품 목록 -->
                <section class="col-b">
                    <div class="list-header">
                        <h2 class="list-title" id="category-title">상품 검색 결과</h2>

                        <!-- 정렬 옵션 -->
                        <nav class="sort-tabs">
                            <a th:href="@{/product/search(sort='sold',  keyword=${search.keyword},searchName=${search.searchName},
                                 searchDesc=${search.searchDesc}, minPrice=${search.minPrice}, maxPrice=${search.maxPrice})}"
                               th:classappend="${sort}=='sold' ? 'on'">판매많은순</a>

                            <a th:href="@{/product/search(sort='lowPrice', keyword=${search.keyword},searchName=${search.searchName},
                                 searchDesc=${search.searchDesc}, minPrice=${search.minPrice}, maxPrice=${search.maxPrice})}"
                               th:classappend="${sort}=='lowPrice' ? 'on'">낮은가격순</a>

                            <a th:href="@{/product/search(sort='highPrice', keyword=${search.keyword},searchName=${search.searchName},
                                 searchDesc=${search.searchDesc}, minPrice=${search.minPrice}, maxPrice=${search.maxPrice})}"
                               th:classappend="${sort}=='highPrice' ? 'on'">높은가격순</a>

                            <a th:href="@{/product/search(sort='score', keyword=${search.keyword},searchName=${search.searchName},
                                 searchDesc=${search.searchDesc}, minPrice=${search.minPrice}, maxPrice=${search.maxPrice})}"
                               th:classappend="${sort}=='score' ? 'on'">평점높은순</a>

                            <a th:href="@{/product/search(sort='review', keyword=${search.keyword},searchName=${search.searchName},
                                 searchDesc=${search.searchDesc}, minPrice=${search.minPrice}, maxPrice=${search.maxPrice})}"
                               th:classappend="${sort}=='review' ? 'on'">후기많은순</a>

                            <a th:href="@{/product/search(sort='recent', keyword=${search.keyword},searchName=${search.searchName},
                                 searchDesc=${search.searchDesc}, minPrice=${search.minPrice}, maxPrice=${search.maxPrice})}"
                               th:classappend="${sort}=='recent' ? 'on'">최근등록순</a>
                        </nav>
                    </div>

                    <div class="search-grid">
                        <!-- 검색 박스 -->
                        <div class="search-box">
                            <!-- 검색 결과 타이틀 -->
                            <div class="search-result-title">
                                <h2>
                                    <span class="keyword">
                                        "<span th:text="${search.keyword}"></span>"
                                    </span> 에 대한 검색 결과
                                </h2>
                                <p class="result-count">
                                    총 <strong th:text="${#lists.size(products)}"></strong>건
                                </p>
                            </div>

                            <div class="search-result-inner">
                                <form th:action="@{/product/search}" method="get" class="search-form">
                                    <div class="search-result-input">
                                        <input type="text" name="keyword" th:value="${search.keyword}" placeholder="검색어 입력">
                                        <button type="submit" class="btn-search">검색</button>
                                    </div>

                                    <div class="search-result-check">
                                        <label><input type="checkbox" name="searchName" value="true" th:checked="${search.searchName}"> 상품명</label>
                                        <label><input type="checkbox" name="searchDesc" value="true" th:checked="${search.searchDesc}"> 설명</label>
                                        <label><input type="checkbox" name="searchPrice" value="true" th:checked="${search.searchPrice}"> 가격</label>
                                        <input type="number" name="minPrice" placeholder="최소가격" th:value="${search.minPrice}">
                                        ~
                                        <input type="number" name="maxPrice" placeholder="최대가격" th:value="${search.maxPrice}">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <div class="product-grid">
                        <div class="product-card" th:each="prod : ${products}">
                            <a th:href="@{/product/view(prodNo=${prod.prodNumber})}">
                                <div class="product-thumb">
                                    <img th:src="${prod.img1} != null ? @{${prod.img1}} : @{/images/product/placeholder.png}" alt="">
                                </div>
                                <p class="product-name" th:text="${prod.prodName}">상품명</p>
                                <strong class="product-sale"
                                        th:text="${#numbers.formatInteger(prod.salePrice, 3, 'COMMA')} + '원'">0원</strong>
                                <p class="product-delivery"
                                   th:text="${prod.deliveryFee == 0 ? '무료배송' : #numbers.formatInteger(prod.deliveryFee, 3, 'COMMA') + '원 배송'}">
                                </p>
                            </a>
                        </div>
                    </div>

                    <div th:if="${#lists.isEmpty(products)}" class="empty">
                        검색 결과가 없습니다.
                    </div>

                    <!-- 페이지네이션 -->
                    <nav class="pagination">
                        <a href="#" class="page-link prev" aria-label="이전 페이지">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="lucide lucide-chevron-left-icon lucide-chevron-left">
                                <path d="m15 18-6-6 6-6"/>
                            </svg>
                        </a>
                        <a href="#" class="page-link active">1</a>
                        <a href="#" class="page-link">2</a>
                        <a href="#" class="page-link">3</a>
                        <a href="#" class="page-link">4</a>
                        <a href="#" class="page-link next" aria-label="다음 페이지">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="lucide lucide-chevron-right-icon lucide-chevron-right">
                                <path d="m9 18 6-6-6-6"/>
                            </svg>
                        </a>
                        <a href="#" class="page-link GTEnd" aria-label="맨 끝으로 이동">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="lucide lucide-chevrons-right-icon lucide-chevrons-right">
                                <path d="m6 17 5-5-5-5"/><path d="m13 17 5-5-5-5"/>
                            </svg>
                        </a>
                    </nav>
                </section>
            </div>

            <!-- TOP 버튼 -->
            <button id="topBtn" class="top-btn" aria-label="맨 위로 이동">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                     class="lucide lucide-chevrons-up-icon lucide-chevrons-up">
                    <path d="m17 11-5-5-5 5"/>
                    <path d="m17 18-5-5-5 5"/>
                </svg>
            </button>

            <!-- 푸터 -->
            <div th:replace="_footer :: footerFragment"></div>
        </div>
    </main>
</body>
</html>