<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cupang::주문완료 (5조)</title>
    <link rel="stylesheet" th:href="@{/css/product/style_header.css}">
    <link rel="stylesheet" th:href="@{/css/product/style_footer.css}">
    <link rel="stylesheet" th:href="@{/css/product/style_index.css}">
    <link rel="stylesheet" th:href="@{/css/product/style_prodList.css}">
    <link rel="stylesheet" th:href="@{/css/product/style_prodComplete.css}">

<!--    &lt;!&ndash; 유저별 권한 기능 &ndash;&gt;-->
<!--    <script th:inline="javascript">-->
<!--        /*<![CDATA[*/-->
<!--        let userType = /*[[${session.member != null ? (session.member.auth == 9 ? 'admin' : 'user') : 'guest'}]]*/ "guest";-->
<!--        let userName = /*[[${session.member != null ? session.member.name : ''}]]*/ "";-->
<!--        /*]]>*/-->
<!--    </script>-->
<!--    <script th:src="@{/js/main/user-menu.js}" defer></script>-->

    <!-- 헤더 상단 공용 검색 기능 -->
    <script th:src="@{/js/product/header-search.js}" defer></script>
    <!-- 상품 리스트 내부 검색 + 정렬 기능 -->
    <script th:src="@{/js/product/search.js}" defer></script>
    <!-- 전체 카테고리 구현 기능 -->
    <script th:inline="javascript">
        /*<![CDATA[*/
        const CATEGORY_DATA = /*[[${categories}]]*/ {};
        console.log(CATEGORY_DATA);
        /*]]>*/
    </script>
    <script th:src="@{/js/product/category.js}" defer></script>
    <!-- 베스트상품 온앤오프 & 스크롤 기능 -->
    <script th:src="@{/js/product/best.js}" defer></script>
</head>
<body>
    <main class="page">

        <!-- 헤더 -->
        <div th:replace="~{_header :: headerFragment}"></div>

        <!-- 주문/결제 레이아웃 -->
        <aside class="order-wrap">

            <!-- 베스트상품 -->
            <aside class="col-a">
                <div class="best-panel">
                    <h3 class="section-title">베스트상품</h3>
                    <ol class="best-num-list" id="best-num-list">
                        <li><button data-idx="0">NO.1</button></li>
                        <li><button data-idx="1">NO.2</button></li>
                        <li><button data-idx="2">NO.3</button></li>
                        <li><button data-idx="3">NO.4</button></li>
                        <li><button data-idx="4">NO.5</button></li>
                    </ol>
                </div>
            </aside>

            <!-- 우측: 주문/결제 -->
            <section class="col-b">

                <div class="list-header">
                    <h2 class="list-title">주문완료</h2>

                    <!-- 경로 네비게이션 -->
                    <nav class="cart-steps">
                        <ol>
                            <li><a href="#">01 옵션선택</a></li>
                            <li><a th:href="@{/product/cart}">02 장바구니</a></li>
                            <li><a th:href="@{/product/order}">03 주문/결제</a></li>
                            <li class="active">04 주문완료</li>
                        </ol>
                    </nav>
                </div>

                <!-- 주문 내역 -->
                <div class="order-grid">
                    <!-- 좌측: 주문 상세 -->
                    <div class="order-list">

                        <!-- 완료 메시지 -->
                        <div class="complete-message">
                            <h2>주문이 정상적으로 완료되었습니다.</h2>
                            <p>주문번호: <strong th:text="${order.order_number}"></strong></p>
                        </div>

                        <!-- 배송지 정보 -->
                        <div class="order-section delivery-box">
                            <div class="section-header">
                                <h3>배송지 정보</h3>
                            </div>
                            <div class="delivery-info">
                                <div class="form-row">
                                    <label>이름</label>
                                    <input type="text" th:value="${order.name}" readonly>
                                </div>
                                <div class="form-row">
                                    <label>연락처</label>
                                    <input type="text" th:value="${order.hp}" readonly>
                                </div>
                                <div class="form-row">
                                    <label>주소</label>
                                    <input type="text"
                                           th:value="${order.addr} + ' ' + ${order.addr2}" readonly>
                                </div>
                            </div>
                        </div>

                        <!-- ✅ 포인트 혜택 -->
                        <div class="order-section point-benefit">
                            <div class="section-header">
                                <h3>포인트 혜택</h3>
                            </div>
                            <p>총 적립 예정 포인트
                                <span th:text="${#numbers.formatInteger(order.salePrice * 0.01, 3, 'COMMA')}"></span>P
                            </p>
                        </div>
                    </div>

                    <!-- 우측: 상품 및 결제 요약 -->
                    <aside class="order-summary">
                        <h3>최종 주문정보</h3>

                        <!-- ✅ 주문 상품 목록 -->
                        <div th:each="item : ${details}" class="product-info">
                            <img th:src="@{${item.img1}}" alt="상품" class="product-thumb">
                            <div class="product-detail">
                                <p class="product-name" th:text="${item.prod_name}"></p>
                                <p class="product-option" th:text="${item.manufacture}"></p>
                                <strong class="sale"
                                        th:text="${#numbers.formatInteger(item.salePrice, 3, 'COMMA')}"></strong>원
                            </div>
                        </div>

                        <!-- ✅ 결제 상세 -->
                        <h3>결제상세</h3>
                        <div class="final-product-info">
                            <ul>
                                <li>
                                    <span>상품수</span>
                                    <span><strong th:text="${order.piece}"></strong>개</span>
                                </li>

                                <li><span>상품금액</span><span><strong
                                        th:text="${#numbers.formatInteger(order.price != null ? order.price : 0,3,'COMMA')}"></strong>원</span></li>
                                <li><span>배송비</span><strong>무료배송</strong></li>
                                <li><span>적립 포인트</span><span><strong
                                        th:text="${#numbers.formatInteger(order.salePrice * 0.01, 3, 'COMMA')}"></strong>P</span></li>
                            </ul>
                            <p class="order-total">
                                <strong th:text="${#numbers.formatInteger(order.price - (order.discount != null ? order.discount : 0),3,'COMMA')}"></strong>원
                            </p>
                        </div>
                    </aside>

                    <!-- 버튼 -->
                    <div class="final-complete-btn">
                        <a th:href="@{/}" class="btn-home">홈으로</a>
                        <a th:href="@{/my/order}" class="btn-order">주문내역 확인</a>
                    </div>
                </div>
            </section>
        </aside>

        <!-- 푸터 -->
        <div th:replace="~{_footer :: footerFragment}"></div>
    </main>
</body>
</html>